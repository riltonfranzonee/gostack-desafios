{"version":3,"sources":["SwitchRouter.js"],"names":["invariant","getScreenForRouteName","createConfigGetter","NavigationActions","SwitchActions","StackActions","validateRouteConfigMap","createPathParser","defaultActionCreators","routeConfigs","config","order","Object","keys","getCustomActionCreators","initialRouteParams","initialRouteName","backBehavior","resetOnBlur","hasOwnProperty","initialRouteIndex","indexOf","Error","map","n","join","childRouters","forEach","routeName","screen","router","getParamsForRoute","params","routeConfig","getPathAndParamsForRoute","getActionForPathAndParams","resetChildRoute","initialParams","undefined","childRouter","childAction","init","getStateForAction","key","getNextState","action","prevState","possibleNextState","updateNextStateHistory","nextState","index","nextRouteKeyHistory","routeKeyHistory","type","NAVIGATE","keyToAdd","routes","filter","k","push","BACK","pop","prevRouteName","nextRoutes","getInitialState","initialState","isTransitioning","initialKey","getActionCreators","route","stateKey","inputState","state","activeChildIndex","INIT","JUMP_TO","findIndex","i","activeChildLastState","activeChildRouter","activeChildState","isBackEligible","Math","max","length","routeKey","didNavigate","find","childId","childState","newChildState","childStateUpdate","SET_PARAMS","lastRoute","isActionBackOrPop","POP","POP_TO_TOP","sendActionToInactiveChildren","preserveFocus","getComponentForState","getComponentForRouteName","getPathAndParamsForState","path","getScreenOptions","defaultNavigationOptions"],"mappings":"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","sourcesContent":["import invariant from '../utils/invariant';\nimport getScreenForRouteName from './getScreenForRouteName';\nimport createConfigGetter from './createConfigGetter';\n\nimport * as NavigationActions from '../NavigationActions';\nimport * as SwitchActions from './SwitchActions';\nimport * as StackActions from './StackActions';\nimport validateRouteConfigMap from './validateRouteConfigMap';\nimport { createPathParser } from './pathUtils';\n\nconst defaultActionCreators = () => ({});\n\nexport default (routeConfigs, config = {}) => {\n  // Fail fast on invalid route definitions\n  validateRouteConfigMap(routeConfigs);\n\n  const order = config.order || Object.keys(routeConfigs);\n\n  const getCustomActionCreators =\n    config.getCustomActionCreators || defaultActionCreators;\n\n  const initialRouteParams = config.initialRouteParams;\n  const initialRouteName = config.initialRouteName || order[0];\n  const backBehavior = config.backBehavior || 'none';\n  const resetOnBlur = config.hasOwnProperty('resetOnBlur')\n    ? config.resetOnBlur\n    : true;\n\n  const initialRouteIndex = order.indexOf(initialRouteName);\n  if (initialRouteIndex === -1) {\n    throw new Error(\n      `Invalid initialRouteName '${initialRouteName}'.` +\n        `Should be one of ${order.map(n => `\"${n}\"`).join(', ')}`\n    );\n  }\n\n  const childRouters = {};\n  order.forEach(routeName => {\n    childRouters[routeName] = null;\n    const screen = getScreenForRouteName(routeConfigs, routeName);\n    if (screen.router) {\n      childRouters[routeName] = screen.router;\n    }\n  });\n\n  function getParamsForRoute(routeName, params) {\n    let routeConfig = routeConfigs[routeName];\n    if (routeConfig && routeConfig.params) {\n      return { ...routeConfig.params, ...params };\n    } else {\n      return params;\n    }\n  }\n\n  const {\n    getPathAndParamsForRoute,\n    getActionForPathAndParams,\n  } = createPathParser(childRouters, routeConfigs, config);\n\n  function resetChildRoute(routeName) {\n    let initialParams =\n      routeName === initialRouteName ? initialRouteParams : undefined;\n    // note(brentvatne): merging initialRouteParams *on top* of default params\n    // on the route seems incorrect but it's consistent with existing behavior\n    // in stackrouter\n    let params = getParamsForRoute(routeName, initialParams);\n    const childRouter = childRouters[routeName];\n    if (childRouter) {\n      const childAction = NavigationActions.init();\n      return {\n        ...childRouter.getStateForAction(childAction),\n        key: routeName,\n        routeName,\n        params,\n      };\n    }\n    return {\n      key: routeName,\n      routeName,\n      params,\n    };\n  }\n\n  function getNextState(action, prevState, possibleNextState) {\n    function updateNextStateHistory(prevState, nextState) {\n      if (\n        backBehavior !== 'history' ||\n        (prevState && nextState && nextState.index === prevState.index)\n      ) {\n        return nextState;\n      }\n      let nextRouteKeyHistory = prevState ? prevState.routeKeyHistory : [];\n      if (action.type === NavigationActions.NAVIGATE) {\n        nextRouteKeyHistory = [...nextRouteKeyHistory]; // copy\n        const keyToAdd = nextState.routes[nextState.index].key;\n        nextRouteKeyHistory = nextRouteKeyHistory.filter(k => k !== keyToAdd); // dedup\n        nextRouteKeyHistory.push(keyToAdd);\n      } else if (action.type === NavigationActions.BACK) {\n        nextRouteKeyHistory = [...nextRouteKeyHistory]; // copy\n        nextRouteKeyHistory.pop();\n      }\n      return {\n        ...nextState,\n        routeKeyHistory: nextRouteKeyHistory,\n      };\n    }\n\n    let nextState = possibleNextState;\n    if (\n      prevState &&\n      possibleNextState &&\n      prevState.index !== possibleNextState.index &&\n      resetOnBlur\n    ) {\n      const prevRouteName = prevState.routes[prevState.index].routeName;\n      const nextRoutes = [...possibleNextState.routes];\n      nextRoutes[prevState.index] = resetChildRoute(prevRouteName);\n      nextState = {\n        ...possibleNextState,\n        routes: nextRoutes,\n      };\n    }\n    return updateNextStateHistory(prevState, nextState);\n  }\n\n  function getInitialState() {\n    const routes = order.map(resetChildRoute);\n    const initialState = {\n      routes,\n      index: initialRouteIndex,\n      isTransitioning: false,\n    };\n    if (backBehavior === 'history') {\n      const initialKey = routes[initialRouteIndex].key;\n      initialState['routeKeyHistory'] = [initialKey];\n    }\n    return initialState;\n  }\n\n  return {\n    childRouters,\n\n    getActionCreators(route, stateKey) {\n      return getCustomActionCreators(route, stateKey);\n    },\n\n    getStateForAction(action, inputState) {\n      let prevState = inputState ? { ...inputState } : inputState;\n      let state = inputState || getInitialState();\n      let activeChildIndex = state.index;\n\n      if (action.type === NavigationActions.INIT) {\n        // NOTE(brentvatne): this seems weird... why are we merging these\n        // params into child routes?\n        // ---------------------------------------------------------------\n        // Merge any params from the action into all the child routes\n        const { params } = action;\n        if (params) {\n          state.routes = state.routes.map(route => ({\n            ...route,\n            params: {\n              ...route.params,\n              ...params,\n              ...(route.routeName === initialRouteName\n                ? initialRouteParams\n                : null),\n            },\n          }));\n        }\n      }\n\n      if (\n        action.type === SwitchActions.JUMP_TO &&\n        (action.key == null || action.key === state.key)\n      ) {\n        const { params } = action;\n        const index = state.routes.findIndex(\n          route => route.routeName === action.routeName\n        );\n\n        if (index === -1) {\n          throw new Error(\n            `There is no route named '${\n              action.routeName\n            }' in the navigator with the key '${action.key}'.\\n` +\n              `Must be one of: ${state.routes\n                .map(route => `'${route.routeName}'`)\n                .join(',')}`\n          );\n        }\n\n        return getNextState(action, prevState, {\n          ...state,\n          routes: params\n            ? state.routes.map((route, i) =>\n                i === index\n                  ? {\n                      ...route,\n                      params: {\n                        ...route.params,\n                        ...params,\n                      },\n                    }\n                  : route\n              )\n            : state.routes,\n          index,\n        });\n      }\n\n      // Let the current child handle it\n      const activeChildLastState = state.routes[state.index];\n      const activeChildRouter = childRouters[order[state.index]];\n      if (activeChildRouter) {\n        const activeChildState = activeChildRouter.getStateForAction(\n          action,\n          activeChildLastState\n        );\n        if (!activeChildState && inputState) {\n          return null;\n        }\n        if (activeChildState && activeChildState !== activeChildLastState) {\n          const routes = [...state.routes];\n          routes[state.index] = activeChildState;\n          return getNextState(action, prevState, {\n            ...state,\n            routes,\n          });\n        }\n      }\n\n      // Handle tab changing. Do this after letting the current tab try to\n      // handle the action, to allow inner children to change first\n      const isBackEligible =\n        action.key == null || action.key === activeChildLastState.key;\n      if (action.type === NavigationActions.BACK) {\n        if (isBackEligible && backBehavior === 'initialRoute') {\n          activeChildIndex = initialRouteIndex;\n        } else if (isBackEligible && backBehavior === 'order') {\n          activeChildIndex = Math.max(0, activeChildIndex - 1);\n        }\n        // The history contains current route, so we can only go back\n        // if there is more than one item in the history\n        else if (\n          isBackEligible &&\n          backBehavior === 'history' &&\n          state.routeKeyHistory.length > 1\n        ) {\n          const routeKey =\n            state.routeKeyHistory[state.routeKeyHistory.length - 2];\n          activeChildIndex = order.indexOf(routeKey);\n        }\n      }\n\n      let didNavigate = false;\n      if (action.type === NavigationActions.NAVIGATE) {\n        didNavigate = !!order.find((childId, i) => {\n          if (childId === action.routeName) {\n            activeChildIndex = i;\n            return true;\n          }\n          return false;\n        });\n        if (didNavigate) {\n          const childState = state.routes[activeChildIndex];\n          const childRouter = childRouters[action.routeName];\n          let newChildState = childState;\n\n          if (action.action && childRouter) {\n            const childStateUpdate = childRouter.getStateForAction(\n              action.action,\n              childState\n            );\n            if (childStateUpdate) {\n              newChildState = childStateUpdate;\n            }\n          }\n\n          if (action.params) {\n            newChildState = {\n              ...newChildState,\n              params: {\n                ...(newChildState.params || {}),\n                ...action.params,\n              },\n            };\n          }\n\n          if (newChildState !== childState) {\n            const routes = [...state.routes];\n            routes[activeChildIndex] = newChildState;\n            const nextState = {\n              ...state,\n              routes,\n              index: activeChildIndex,\n            };\n            return getNextState(action, prevState, nextState);\n          } else if (\n            newChildState === childState &&\n            state.index === activeChildIndex &&\n            prevState\n          ) {\n            return null;\n          }\n        }\n      }\n\n      if (action.type === NavigationActions.SET_PARAMS) {\n        const key = action.key;\n        const lastRoute = state.routes.find(route => route.key === key);\n        if (lastRoute) {\n          const params = {\n            ...lastRoute.params,\n            ...action.params,\n          };\n          const routes = [...state.routes];\n          routes[state.routes.indexOf(lastRoute)] = {\n            ...lastRoute,\n            params,\n          };\n          return getNextState(action, prevState, {\n            ...state,\n            routes,\n          });\n        }\n      }\n\n      if (activeChildIndex !== state.index) {\n        return getNextState(action, prevState, {\n          ...state,\n          index: activeChildIndex,\n        });\n      } else if (didNavigate && !inputState) {\n        return state;\n      } else if (didNavigate) {\n        return { ...state };\n      }\n\n      const isActionBackOrPop =\n        action.type === NavigationActions.BACK ||\n        action.type === StackActions.POP ||\n        action.type === StackActions.POP_TO_TOP;\n      const sendActionToInactiveChildren =\n        !isActionBackOrPop ||\n        (action.type === NavigationActions.BACK && action.key != null);\n\n      // Let other children handle it and switch to the first child that returns a new state\n      // Do not do this for StackActions.POP or NavigationActions.BACK actions without a key:\n      // it would be unintuitive for these actions to switch to another tab just because that tab had a Stack that could accept a back action\n      if (sendActionToInactiveChildren) {\n        let index = state.index;\n        let routes = state.routes;\n        order.find((childId, i) => {\n          const childRouter = childRouters[childId];\n          if (i === index) {\n            return false;\n          }\n          let childState = routes[i];\n          if (childRouter) {\n            childState = childRouter.getStateForAction(action, childState);\n          }\n          if (!childState) {\n            index = i;\n            return true;\n          }\n          if (childState !== routes[i]) {\n            routes = [...routes];\n            routes[i] = childState;\n            index = i;\n            return true;\n          }\n          return false;\n        });\n\n        // Nested routers can be updated after switching children with actions such as SET_PARAMS\n        // and COMPLETE_TRANSITION.\n        if (action.preserveFocus) {\n          index = state.index;\n        }\n\n        if (index !== state.index || routes !== state.routes) {\n          return getNextState(action, prevState, {\n            ...state,\n            index,\n            routes,\n          });\n        }\n      }\n\n      return state;\n    },\n\n    getComponentForState(state) {\n      const routeName = state.routes[state.index].routeName;\n      invariant(\n        routeName,\n        `There is no route defined for index ${state.index}. Check that\n        that you passed in a navigation state with a valid tab/screen index.`\n      );\n      const childRouter = childRouters[routeName];\n      if (childRouter) {\n        return childRouter.getComponentForState(state.routes[state.index]);\n      }\n      return getScreenForRouteName(routeConfigs, routeName);\n    },\n\n    getComponentForRouteName(routeName) {\n      return getScreenForRouteName(routeConfigs, routeName);\n    },\n\n    getPathAndParamsForState(state) {\n      const route = state.routes[state.index];\n      return getPathAndParamsForRoute(route);\n    },\n\n    getActionForPathAndParams(path, params) {\n      return getActionForPathAndParams(path, params);\n    },\n\n    getScreenOptions: createConfigGetter(\n      routeConfigs,\n      config.defaultNavigationOptions\n    ),\n  };\n};\n"]}